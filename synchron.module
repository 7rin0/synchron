<?php

/**
 * @file
 * Drupal hooks.
 */

use Drupal\Core\Entity\EntityTypeInterface;
use \Drupal\node\Entity\Node;
use Drupal\Core\Field\BaseFieldDefinition;

/**
 * Update targeted entities schema.
 *
 * @param EntityTypeInterface $entity_type
 *   Entity.
 *
 * @return array
 *   Return the desired schema to the current Entity.
 */
function synchron_entity_base_field_info(EntityTypeInterface $entity_type) {
  // TODO: DO we need to affect every single entity? Yes we do!
  if ($entity_type->id() == 'node') {
    $fields = [];
    $fields['synchronid'] = BaseFieldDefinition::create('integer')
      ->setDefaultValue(0)
      ->setLabel('Shared ID by two synchronized entities');
    return $fields;
  }
}

/**
 * Prepare this to auto-synchronizations.
 *
 * @param Node $originalEntity
 *   Entity.
 */
function synchron_node_presave(Node $originalEntity) {
  // TODO if theres a synchronid auto update;.
  // TODO: Add synchro id field.
  // If entity exists.
  if ($originalEntity) {
    $synchronService = \Drupal::service('synchron');
  }
}
